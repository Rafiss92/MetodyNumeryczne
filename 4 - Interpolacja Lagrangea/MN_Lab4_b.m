% Autor - Rafał Mastalerz
%Dane
w0=[-5,5];
w1=[-3,1];
w2=[1,2];
w3=[2,-1];
w4=[-2,4];
w5=[4,-1];

%Macierz wezlow
w = [w0;w1;w2;w3;w4;w5];

%Baza wielomianu Lagrange'a
fi = zeros(1,6);
fi(1)=(w(1,1)-w(2,1))*(w(1,1)-w(3,1))*(w(1,1)-w(4,1))*(w(1,1)-w(5,1))*(w(1,1)-w(6,1));
fi(2)=(w(2,1)-w(1,1))*(w(2,1)-w(3,1))*(w(2,1)-w(4,1))*(w(2,1)-w(5,1))*(w(2,1)-w(6,1));
fi(3)=(w(3,1)-w(2,1))*(w(3,1)-w(1,1))*(w(3,1)-w(4,1))*(w(3,1)-w(5,1))*(w(3,1)-w(6,1));
fi(4)=(w(4,1)-w(1,1))*(w(4,1)-w(2,1))*(w(4,1)-w(3,1))*(w(4,1)-w(5,1))*(w(4,1)-w(6,1));
fi(5)=(w(5,1)-w(1,1))*(w(5,1)-w(2,1))*(w(5,1)-w(3,1))*(w(5,1)-w(4,1))*(w(5,1)-w(6,1));
fi(6)=(w(6,1)-w(1,1))*(w(6,1)-w(2,1))*(w(6,1)-w(3,1))*(w(6,1)-w(4,1))*(w(6,1)-w(5,1));

%Wspolczynniki wielomianu Lagrange'a
a = zeros(1,6);
for i = 1:6
  a(i) = w(i,2) / fi(i);
endfor

% wzory na współczynniki:

% wspolczynnik przy potędze 5 = a
% wspolczynnik przy potędze 4 = -a(n+m+b+c+d)
% wspolczynnik przy potędze 3 = a(mn+m(b+c+d)+n(b+c+d)+bc+bd+cd)
% wspolczynnik przy potędze 2 = -a(mn(b+c+d)+n(bc+bd+cd)+m(bc+bd+cd)+bcd)
% wspolczynnik przy potędze 1 = a(mn(bc+bd+cd)+bcd(m+n))
% wspolczynnik przy potędze 0 = -a(mnbcd)

wsp = zeros(1,6);

wsp(1)=-a(1)*(w(2,1)*w(3,1)*w(4,1)*w(5,1)*w(6,1))-a(2)*(w(1,1)*w(3,1)*w(4,1)*w(5,1)*w(6,1))-a(3)*(w(2,1)*w(1,1)*w(4,1)*w(5,1)*w(6,1))-a(4)*(w(2,1)*w(3,1)*w(1,1)*w(5,1)*w(6,1))-a(5)*(w(2,1)*w(3,1)*w(4,1)*w(1,1)*w(6,1))-a(6)*(w(2,1)*w(3,1)*w(4,1)*w(5,1)*w(1,1));
wsp(2)=a(1)*(w(2,1)*w(3,1)*(w(4,1)*w(5,1)+w(4,1)*w(6,1)+w(5,1)*w(6,1))+w(4,1)*w(5,1)*w(6,1)*(w(2,1)+w(3,1)))+a(2)*(w(1,1)*w(3,1)*(w(4,1)*w(5,1)+w(4,1)*w(6,1)+w(5,1)*w(6,1))+w(4,1)*w(5,1)*w(6,1)*(w(1,1)+w(3,1)))+a(3)*(w(1,1)*w(2,1)*(w(4,1)*w(5,1)+w(4,1)*w(6,1)+w(5,1)*w(6,1))+w(4,1)*w(5,1)*w(6,1)*(w(1,1)+w(2,1)))+a(4)*(w(1,1)*w(2,1)*(w(3,1)*w(5,1)+w(3,1)*w(6,1)+w(5,1)*w(6,1))+w(3,1)*w(5,1)*w(6,1)*(w(1,1)+w(2,1)))+a(5)*(w(1,1)*w(2,1)*(w(3,1)*w(4,1)+w(3,1)*w(6,1)+w(4,1)*w(6,1))+w(3,1)*w(4,1)*w(6,1)*(w(1,1)+w(2,1)))+a(6)*(w(1,1)*w(2,1)*(w(3,1)*w(4,1)+w(3,1)*w(5,1)+w(4,1)*w(5,1))+w(3,1)*w(4,1)*w(5,1)*(w(1,1)+w(2,1)));
wsp(3)=-a(1)*(w(2,1)*w(3,1)*(w(4,1)+w(5,1)+w(6,1))+w(3,1)*(w(4,1)*w(5,1)+w(4,1)*w(6,1)+w(5,1)*w(6,1))+w(2,1)*(w(4,1)*w(5,1)+w(4,1)*w(6,1)+w(5,1)*w(6,1))+w(4,1)*w(5,1)*w(6,1))-a(2)*(w(1,1)*w(3,1)*(w(4,1)+w(5,1)+w(6,1))+w(3,1)*(w(4,1)*w(5,1)+w(4,1)*w(6,1)+w(5,1)*w(6,1))+w(1,1)*(w(4,1)*w(5,1)+w(4,1)*w(6,1)+w(5,1)*w(6,1))+w(4,1)*w(5,1)*w(6,1))-a(3)*(w(1,1)*w(2,1)*(w(4,1)+w(5,1)+w(6,1))+w(2,1)*(w(4,1)*w(5,1)+w(4,1)*w(6,1)+w(5,1)*w(6,1))+w(1,1)*(w(4,1)*w(5,1)+w(4,1)*w(6,1)+w(5,1)*w(6,1))+w(4,1)*w(5,1)*w(6,1))-a(4)*(w(1,1)*w(2,1)*(w(3,1)+w(5,1)+w(6,1))+w(2,1)*(w(3,1)*w(5,1)+w(3,1)*w(6,1)+w(5,1)*w(6,1))+w(1,1)*(w(3,1)*w(5,1)+w(3,1)*w(6,1)+w(5,1)*w(6,1))+w(3,1)*w(5,1)*w(6,1))-a(5)*(w(1,1)*w(2,1)*(w(3,1)+w(4,1)+w(6,1))+w(2,1)*(w(3,1)*w(4,1)+w(3,1)*w(6,1)+w(4,1)*w(6,1))+w(1,1)*(w(3,1)*w(4,1)+w(3,1)*w(6,1)+w(4,1)*w(6,1))+w(3,1)*w(4,1)*w(6,1))-a(6)*(w(1,1)*w(2,1)*(w(3,1)+w(4,1)+w(5,1))+w(2,1)*(w(3,1)*w(4,1)+w(3,1)*w(5,1)+w(4,1)*w(5,1))+w(1,1)*(w(3,1)*w(4,1)+w(3,1)*w(5,1)+w(4,1)*w(5,1))+w(3,1)*w(4,1)*w(5,1));
wsp(4)=a(1)*(w(2,1)*w(3,1)+w(2,1)*(w(4,1)+w(5,1)+w(6,1))+w(3,1)*(w(4,1)+w(5,1)+w(6,1))+w(4,1)*w(5,1)+w(4,1)*w(6,1)+w(5,1)*w(6,1))+a(2)*(w(1,1)*w(3,1)+w(1,1)*(w(4,1)+w(5,1)+w(6,1))+w(3,1)*(w(4,1)+w(5,1)+w(6,1))+w(4,1)*w(5,1)+w(4,1)*w(6,1)+w(5,1)*w(6,1))+a(3)*(w(1,1)*w(2,1)+w(1,1)*(w(4,1)+w(5,1)+w(6,1))+w(2,1)*(w(4,1)+w(5,1)+w(6,1))+w(4,1)*w(5,1)+w(4,1)*w(6,1)+w(5,1)*w(6,1))+a(4)*(w(1,1)*w(2,1)+w(1,1)*(w(3,1)+w(5,1)+w(6,1))+w(2,1)*(w(3,1)+w(5,1)+w(6,1))+w(3,1)*w(5,1)+w(3,1)*w(6,1)+w(5,1)*w(6,1))+a(5)*(w(1,1)*w(2,1)+w(1,1)*(w(3,1)+w(4,1)+w(6,1))+w(2,1)*(w(3,1)+w(4,1)+w(6,1))+w(3,1)*w(4,1)+w(3,1)*w(6,1)+w(4,1)*w(6,1))+a(6)*(w(1,1)*w(2,1)+w(1,1)*(w(3,1)+w(4,1)+w(5,1))+w(2,1)*(w(3,1)+w(4,1)+w(5,1))+w(3,1)*w(4,1)+w(3,1)*w(5,1)+w(4,1)*w(5,1));
wsp(5)=-a(1)*(w(2,1)+w(3,1)+w(4,1)+w(5,1)+w(6,1))-a(2)*(w(1,1)+w(3,1)+w(4,1)+w(5,1)+w(6,1))-a(3)*(w(1,1)+w(2,1)+w(4,1)+w(5,1)+w(6,1))-a(4)*(w(1,1)+w(2,1)+w(3,1)+w(5,1)+w(6,1))-a(5)*(w(1,1)+w(2,1)+w(3,1)+w(4,1)+w(6,1))-a(6)*(w(1,1)+w(2,1)+w(3,1)+w(4,1)+w(5,1));
wsp(6)=a(1)+a(2)+a(3)+a(4)+a(5)+a(6);

fprintf("W(x) =%f x^5 + %f x^4 + %f x^3 + %f x^2 + %f x + %f\n", wsp(6), wsp(5), wsp(4), wsp(3), wsp(2),wsp(1));

%Wykres na podstawie wzoru interpolacyjnego
x = [-6:1:6];
y = zeros(1,13);
for i=1:13
  fi(1) = (x(i)-w(2,1))*(x(i)-w(3,1))*(x(i)-w(4,1))*(x(i)-w(5,1))*(x(i)-w(6,1));
  fi(2) = (x(i)-w(1,1))*(x(i)-w(3,1))*(x(i)-w(4,1))*(x(i)-w(5,1))*(x(i)-w(6,1));
  fi(3) = (x(i)-w(1,1))*(x(i)-w(2,1))*(x(i)-w(4,1))*(x(i)-w(5,1))*(x(i)-w(6,1));
  fi(4) = (x(i)-w(1,1))*(x(i)-w(2,1))*(x(i)-w(3,1))*(x(i)-w(5,1))*(x(i)-w(6,1));
  fi(5) = (x(i)-w(1,1))*(x(i)-w(2,1))*(x(i)-w(3,1))*(x(i)-w(4,1))*(x(i)-w(6,1));
  fi(6) = (x(i)-w(1,1))*(x(i)-w(2,1))*(x(i)-w(3,1))*(x(i)-w(4,1))*(x(i)-w(5,1));
  y(i) = a(1)*fi(1) + a(2)*fi(2) + a(3)*fi(3) + a(4)*fi(4) + a(5)*fi(5) + a(6)*fi(6);
endfor
plot(x,y);
grid on;
hold on;

%Wykres punktow obliczonych ze wzoru ogolnego
vector_x=[w(1,1),w(2,1),w(3,1), w(4,1), w(5,1), w(6,1)];
vector_y=zeros(1,6);
for i=1:6
  for j=1:6
    vector_y(1,j) = vector_y(1,j)+wsp(i)*w(j,1)^(i-1);
  endfor
endfor
disp(vector_y);
plot(vector_x,vector_y,'rx'); %Czerwone krzyzyki

%Wykres wezlow otrzymany z podanych wspolrzednych punktow: w0, w1, w2, w3, w4, w5
for i=1:6
  plot(w(i,1),w(i,2),'--gs');
endfor
title("Interpolacja Lagrange'a");
ylabel("Os y");
xlabel("Os x");